<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debt Freedom Calculator | Financial Planning Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        .shadow-soft {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .input-highlight {
            transition: all 0.2s ease;
        }
        .input-highlight:focus {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="text-center mb-12">
            <img src="https://placehold.co/100x100/3b82f6/ffffff?text=DFC" alt="Debt Freedom Calculator Logo" class="mx-auto mb-4 rounded-full shadow-soft" onerror="this.onerror=null;this.src='https://placehold.co/100x100/cccccc/ffffff?text=Error';">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Debt Freedom Calculator</h1>
            <p class="text-lg text-gray-600">Plan your path to financial independence.</p>
        </header>

        <!-- Main Calculator Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Section -->
            <div class="bg-white p-8 rounded-lg shadow-soft">
                <h2 class="text-2xl font-semibold text-gray-700 mb-6">Your Financial Details</h2>
                
                <!-- Income Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium text-gray-700 mb-4 border-b pb-2">Monthly Income</h3>
                    <div class="space-y-4">
                        <div>
                            <label for="primary-income" class="block text-sm font-medium text-gray-700 mb-1">Primary Income ($)</label>
                            <input type="number" id="primary-income" class="input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="4000" min="0" step="100">
                        </div>
                        <div>
                            <label for="secondary-income" class="block text-sm font-medium text-gray-700 mb-1">Secondary Income ($)</label>
                            <input type="number" id="secondary-income" class="input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="500" min="0" step="100">
                        </div>
                    </div>
                </div>

                <!-- Expenses Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium text-gray-700 mb-4 border-b pb-2">Monthly Expenses</h3>
                    <div class="space-y-4" id="expenses-container">
                        <!-- Expense items will be added here dynamically -->
                    </div>
                    <button id="add-expense" class="mt-3 bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition">+ Add Another Expense</button>
                </div>

                <!-- Debts Section -->
                <div>
                    <h3 class="text-lg font-medium text-gray-700 mb-4 border-b pb-2">Current Debts</h3>
                    <div class="space-y-4" id="debts-container">
                        <!-- Debt items will be added here dynamically -->
                    </div>
                    <button id="add-debt" class="mt-3 bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition">+ Add Another Debt</button>
                    
                    <!-- Strategy Selection -->
                    <div class="mt-6">
                        <label for="payoff-strategy-select" class="block text-sm font-medium text-gray-700 mb-1">Debt Payoff Strategy</label>
                        <select id="payoff-strategy-select" class="input-highlight w-full px-4 py-2 border rounded-md focus:outline-none bg-white">
                            <option value="snowball" selected>Debt Snowball (Lowest Balance First)</option>
                            <option value="avalanche">Debt Avalanche (Highest Interest First)</option>
                        </select>
                    </div>

                    <!-- Extra Monthly Payment -->
                    <div class="mt-6">
                        <label for="extra-payment" class="block text-sm font-medium text-gray-700 mb-1">Extra Monthly Payment ($)</label>
                        <input type="number" id="extra-payment" class="input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="200" min="0" step="10">
                    </div>
                </div>

                <button id="calculate-btn" class="w-full bg-green-600 text-white py-3 mt-8 rounded-md font-semibold hover:bg-green-700 transition text-lg">Calculate My Debt Freedom Plan</button>
            </div>

            <!-- Results Section -->
            <div class="bg-white p-8 rounded-lg shadow-soft">
                <h2 class="text-2xl font-semibold text-gray-700 mb-6">Your Debt Freedom Plan</h2>
                
                <div id="results-container" class="text-center p-4 bg-gray-50 rounded-lg hidden">
                    <div class="mb-8">
                        <p class="text-gray-600">You'll be debt-free by</p>
                        <p class="text-3xl font-bold text-green-600" id="projected-date">-</p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Total Debt</p>
                            <p class="text-xl font-bold text-blue-700" id="total-debt">$0</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Total Interest Paid</p>
                            <p class="text-xl font-bold text-blue-700" id="total-interest">$0</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Total Monthly Payment</p>
                            <p class="text-xl font-bold text-blue-700" id="total-payment">$0</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Months to Freedom</p>
                            <p class="text-xl font-bold text-blue-700" id="months-to-freedom">0</p>
                        </div>
                    </div>

                    <canvas id="debtProgressChart" height="200"></canvas>
                    <canvas id="expensesChart" class="mt-8" height="200"></canvas>

                    <div class="mt-8 text-left">
                        <h3 class="text-lg font-medium text-gray-700 mb-3">Your Payoff Strategy</h3>
                        <ul class="space-y-2 text-gray-600 list-disc list-inside" id="payoff-strategy">
                            <!-- Payoff strategy will be added here dynamically -->
                        </ul>
                    </div>

                    <div class="mt-8 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-sm text-left">
                        <h4 class="font-semibold text-yellow-800 mb-2">Financial Insights</h4>
                        <p id="financial-insight" class="text-yellow-900"></p>
                    </div>
                </div>

                <div id="empty-state" class="text-center p-8">
                    <img src="https://placehold.co/300x200/e0e7ff/3730a3?text=Enter+Your+Data" alt="Illustration of financial documents" class="mx-auto mb-6 rounded-lg" onerror="this.onerror=null;this.src='https://placehold.co/300x200/cccccc/ffffff?text=Error';">
                    <h3 class="text-xl font-medium text-gray-700 mb-2">Enter Your Financial Details</h3>
                    <p class="text-gray-600 mb-4">Fill in the fields to see your personalized debt freedom plan.</p>
                    <p class="text-sm text-gray-500">We'll calculate when you'll be debt-free and show you the best strategy to get there.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- STATE & INITIALIZATION ---
        let expenseCounter = 0;
        let debtCounter = 0;
        let expenseChartInstance = null;
        let debtProgressChartInstance = null;
    
        const expensesContainer = document.getElementById('expenses-container');
        const debtsContainer = document.getElementById('debts-container');
    
        // --- DYNAMIC FIELD FUNCTIONS ---
    
        // Function to add a new expense field
        const addExpenseField = () => {
            expenseCounter++;
            const newExpense = document.createElement('div');
            newExpense.className = 'expense-item flex gap-2 items-end mt-2';
            newExpense.innerHTML = `
                <div class="flex-grow">
                    ${expenseCounter === 1 ? '<label for="expense-1" class="block text-sm font-medium text-gray-700 mb-1">Expense Name</label>' : ''}
                    <input type="text" id="expense-${expenseCounter}" class="expense-name input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="e.g., Rent, Utilities">
                </div>
                <div class="w-32">
                     ${expenseCounter === 1 ? '<label for="amount-1" class="block text-sm font-medium text-gray-700 mb-1">Amount ($)</label>' : ''}
                    <input type="number" id="amount-${expenseCounter}" class="expense-amount input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="0" min="0" step="10">
                </div>
                <button class="delete-item bg-red-100 text-red-600 px-2 py-2 rounded-md hover:bg-red-200 transition" aria-label="Remove item">✕</button>
            `;
            expensesContainer.appendChild(newExpense);
            newExpense.querySelector('.delete-item').addEventListener('click', () => newExpense.remove());
        };
    
        // Function to add a new debt field
        const addDebtField = () => {
            debtCounter++;
            const newDebt = document.createElement('div');
            newDebt.className = 'debt-item flex gap-2 items-end mt-2';
            newDebt.innerHTML = `
                <div class="flex-grow">
                    ${debtCounter === 1 ? '<label for="debt-1" class="block text-sm font-medium text-gray-700 mb-1">Debt Name</label>' : ''}
                    <input type="text" id="debt-${debtCounter}" class="debt-name input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" placeholder="e.g., Credit Card, Student Loan">
                </div>
                <div class="w-24">
                    ${debtCounter === 1 ? '<label for="balance-1" class="block text-sm font-medium text-gray-700 mb-1">Balance ($)</label>' : ''}
                    <input type="number" id="balance-${debtCounter}" class="debt-balance input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="0" min="0" step="100">
                </div>
                <div class="w-24">
                    ${debtCounter === 1 ? '<label for="interest-1" class="block text-sm font-medium text-gray-700 mb-1">Interest (%)</label>' : ''}
                    <input type="number" id="interest-${debtCounter}" class="debt-interest input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="0" min="0" step="0.1">
                </div>
                <div class="w-24">
                    ${debtCounter === 1 ? '<label for="payment-1" class="block text-sm font-medium text-gray-700 mb-1">Min. Pmt ($)</label>' : ''}
                    <input type="number" id="payment-${debtCounter}" class="debt-min-payment input-highlight w-full px-4 py-2 border rounded-md focus:outline-none" value="0" min="0" step="10">
                </div>
                <button class="delete-item bg-red-100 text-red-600 px-2 py-2 rounded-md hover:bg-red-200 transition" aria-label="Remove item">✕</button>
            `;
            debtsContainer.appendChild(newDebt);
            newDebt.querySelector('.delete-item').addEventListener('click', () => newDebt.remove());
        };
        
        // --- EVENT LISTENERS for adding fields ---
        document.getElementById('add-expense').addEventListener('click', addExpenseField);
        document.getElementById('add-debt').addEventListener('click', addDebtField);
        
        // Add initial dynamic fields
        addExpenseField();
        addDebtField();
    
    
        // --- CALCULATION LOGIC ---
        const calculateDebtFreedomPlan = () => {
            // 1. Gather all inputs
            const primaryIncome = parseFloat(document.getElementById('primary-income').value) || 0;
            const secondaryIncome = parseFloat(document.getElementById('secondary-income').value) || 0;
            const totalIncome = primaryIncome + secondaryIncome;
    
            const expenseInputs = document.querySelectorAll('.expense-amount');
            const totalExpenses = Array.from(expenseInputs).reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            const expenseNames = Array.from(document.querySelectorAll('.expense-name')).map(input => input.value || 'Unnamed Expense');
            const expenseValues = Array.from(expenseInputs).map(input => parseFloat(input.value) || 0);
    
            const debtItems = document.querySelectorAll('.debt-item');
            let debts = Array.from(debtItems).map(item => ({
                name: item.querySelector('.debt-name').value || 'Unnamed Debt',
                balance: parseFloat(item.querySelector('.debt-balance').value) || 0,
                interest: parseFloat(item.querySelector('.debt-interest').value) || 0,
                minPayment: parseFloat(item.querySelector('.debt-min-payment').value) || 0,
            })).filter(debt => debt.balance > 0);
            
            const extraPayment = parseFloat(document.getElementById('extra-payment').value) || 0;
            const strategy = document.getElementById('payoff-strategy-select').value;
            
            const totalDebt = debts.reduce((sum, debt) => sum + debt.balance, 0);
            const totalMinPayment = debts.reduce((sum, debt) => sum + debt.minPayment, 0);
            const totalMonthlyPayment = totalMinPayment + extraPayment;
    
            // 2. Simulation Setup: Sort debts based on the selected strategy
            if (strategy === 'avalanche') {
                debts.sort((a, b) => b.interest - a.interest); // Highest interest first
            } else {
                debts.sort((a, b) => a.balance - b.balance); // Lowest balance first (Snowball)
            }
            
            let months = 0;
            let totalInterestPaid = 0;
            let currentTotalDebt = totalDebt;
            const debtProgress = [totalDebt];
            let tempDebts = JSON.parse(JSON.stringify(debts)); // Create a deep copy for simulation
    
            // 3. Run month-by-month simulation
            while (currentTotalDebt > 0 && months < 600) { // Safety break at 50 years
                months++;
                let interestThisMonth = 0;
                
                // Accrue interest on all debts
                for (const debt of tempDebts) {
                    if (debt.balance > 0) {
                        const monthlyInterest = (debt.balance * (debt.interest / 100)) / 12;
                        debt.balance += monthlyInterest;
                        interestThisMonth += monthlyInterest;
                    }
                }
                totalInterestPaid += interestThisMonth;
    
                let paymentPool = totalMonthlyPayment;
    
                // Make minimum payments on all debts
                for (const debt of tempDebts) {
                    if (debt.balance > 0) {
                        const payment = Math.min(debt.balance, debt.minPayment);
                        debt.balance -= payment;
                        paymentPool -= payment;
                    }
                }
    
                // Apply snowball/avalanche payment (extra + paid-off minimums) to the target debt
                for (const debt of tempDebts) {
                    if (debt.balance > 0 && paymentPool > 0) {
                        const extraPay = Math.min(debt.balance, paymentPool);
                        debt.balance -= extraPay;
                        paymentPool -= extraPay;
                    }
                }
                
                currentTotalDebt = tempDebts.reduce((sum, debt) => sum + debt.balance, 0);
                debtProgress.push(Math.max(0, currentTotalDebt));
            }
    
            return {
                totalDebt,
                totalInterest: totalInterestPaid,
                monthlyPayment: totalMonthlyPayment,
                monthsToFreedom: months,
                debtProgress,
                totalIncome,
                totalExpenses,
                expenseNames,
                expenseValues,
                strategy 
            };
        };
    
        // --- DISPLAY RESULTS ---
        const displayResults = (results) => {
            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('results-container').classList.remove('hidden');
    
            const futureDate = new Date();
            futureDate.setMonth(futureDate.getMonth() + results.monthsToFreedom);
            document.getElementById('projected-date').textContent = futureDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
    
            document.getElementById('total-debt').textContent = `$${results.totalDebt.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('total-interest').textContent = `$${results.totalInterest.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('total-payment').textContent = `$${results.monthlyPayment.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            document.getElementById('months-to-freedom').textContent = results.monthsToFreedom;
    
            // Debt Progress Chart
            if (debtProgressChartInstance) debtProgressChartInstance.destroy();
            const debtCtx = document.getElementById('debtProgressChart').getContext('2d');
            debtProgressChartInstance = new Chart(debtCtx, {
                type: 'line', data: {
                    labels: Array.from({ length: results.monthsToFreedom + 1 }, (_, i) => `Month ${i}`),
                    datasets: [{
                        label: 'Remaining Debt Balance', data: results.debtProgress, borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)', fill: true, tension: 0.1
                    }]
                },
                options: {
                    responsive: true, plugins: { title: { display: true, text: 'Debt Balance Over Time' } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Debt Balance ($)' } } }
                }
            });
    
            // Expenses Chart
            if (expenseChartInstance) expenseChartInstance.destroy();
            const expenseCtx = document.getElementById('expensesChart').getContext('2d');
            expenseChartInstance = new Chart(expenseCtx, {
                type: 'doughnut', data: {
                    labels: results.expenseNames,
                    datasets: [{
                        label: 'Expenses', data: results.expenseValues,
                        backgroundColor: ['#3b82f6', '#ef4444', '#f97316', '#84cc16', '#14b8a6', '#a855f7', '#64748b'], borderWidth: 1
                    }]
                },
                options: { responsive: true, plugins: { title: { display: true, text: 'Monthly Expenses Breakdown' } } }
            });
            
            // Payoff Strategy
            const years = Math.floor(results.monthsToFreedom / 12);
            const months = results.monthsToFreedom % 12;
            const strategyText = results.strategy === 'avalanche' ? 
                "Your plan uses the <strong>Debt Avalanche</strong> method, targeting debts with the highest interest rate first to save you the most money." : 
                "Your plan uses the <strong>Debt Snowball</strong> method, targeting debts with the lowest balance first to build momentum.";
            
            document.getElementById('payoff-strategy').innerHTML = `
                <li>${strategyText}</li>
                <li>You'll pay a total of <strong>$${results.monthlyPayment.toLocaleString()}</strong> towards debts each month.</li>
                <li>You are projected to be debt-free in <strong>${years} years and ${months} months</strong>.</li>
            `;
    
            // Financial Insight
            const totalMinPayment = Array.from(document.querySelectorAll('.debt-min-payment')).reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            const disposableIncome = results.totalIncome - results.totalExpenses - totalMinPayment;
            const extraPayment = parseFloat(document.getElementById('extra-payment').value) || 0;
            const insightElement = document.getElementById('financial-insight');
            if (disposableIncome < 0) {
                insightElement.textContent = `Warning: Your monthly expenses and minimum debt payments ($${(results.totalExpenses + totalMinPayment).toLocaleString()}) exceed your income ($${results.totalIncome.toLocaleString()}). This is unsustainable. You must either increase your income or decrease expenses immediately.`;
            } else {
                insightElement.textContent = `After all expenses and minimum debt payments, you have $${disposableIncome.toLocaleString()} left over. Your plan uses $${extraPayment.toLocaleString()} of this for extra debt payments. Great job allocating extra funds to become debt-free faster!`;
            }
        };
    
        // --- MAIN EVENT LISTENER ---
        document.getElementById('calculate-btn').addEventListener('click', () => {
            const results = calculateDebtFreedomPlan();
            if (results.totalDebt > 0) {
                displayResults(results);
            } else {
                // Use a more modern, non-blocking notification if possible, but alert is simple and effective.
                alert("Please enter at least one debt with a balance greater than zero to calculate a plan.");
            }
        });
    });
    </script>
</body>
</html>
